{
  "comments": [
    {
      "key": {
        "uuid": "f776216f_4fbc58c8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 153,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-15T21:18:32Z",
      "side": 1,
      "message": "invalidate() will do since java is typed.",
      "range": {
        "startLine": 153,
        "startChar": 14,
        "endLine": 153,
        "endChar": 36
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a9d9a495_6064cb89",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 153,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-15T21:18:32Z",
      "side": 1,
      "message": "account (since keys mean something different in this file)",
      "range": {
        "startLine": 153,
        "startChar": 48,
        "endLine": 153,
        "endChar": 51
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "07682740_0119354f",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 153,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2019-10-15T21:26:52Z",
      "side": 1,
      "message": "Thanks, done.",
      "parentUuid": "f776216f_4fbc58c8",
      "range": {
        "startLine": 153,
        "startChar": 14,
        "endLine": 153,
        "endChar": 36
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "664ffee5_fb07cbcb",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 153,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2019-10-15T21:26:52Z",
      "side": 1,
      "message": "Thanks, done.",
      "parentUuid": "a9d9a495_6064cb89",
      "range": {
        "startLine": 153,
        "startChar": 48,
        "endLine": 153,
        "endChar": 51
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b3dfdc1a_4ba0ad00",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 156,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-15T21:18:32Z",
      "side": 1,
      "message": "Call invalidate(Object Key) here instead?",
      "range": {
        "startLine": 156,
        "startChar": 8,
        "endLine": 156,
        "endChar": 18
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "12495ed3_cc658047",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 3
      },
      "lineNbr": 156,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2019-10-15T21:26:52Z",
      "side": 1,
      "message": "Thanks, done.",
      "parentUuid": "b3dfdc1a_4ba0ad00",
      "range": {
        "startLine": 156,
        "startChar": 8,
        "endLine": 156,
        "endChar": 18
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "49ff2389_141e24f0",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-15T21:20:04Z",
      "side": 1,
      "message": "This command seems like it belong in core. If we want this ability, we should be able to get it for any kind of session.",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c4b6d8bd_4f37f9be",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2019-10-15T21:22:36Z",
      "side": 1,
      "message": "I\u0027ve tried to implement this in core but failed :(\n\nMaybe you can help?",
      "parentUuid": "49ff2389_141e24f0",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "efcb9490_0ac9f658",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-15T21:35:06Z",
      "side": 1,
      "message": "Sure, where did you get blocked?",
      "parentUuid": "c4b6d8bd_4f37f9be",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed9dc6d2_6a353f06",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2019-10-15T22:38:56Z",
      "side": 1,
      "message": "I tried to get it so that https://github.com/GerritCodeReview/gerrit/blob/master/java/com/google/gerrit/server/cache/h2/H2CacheImpl.java would try and fetch the user from the h2 cache disk file but failed. (this was a long while ago so i doin\u0027t remember exactly what i did :()\n\nI also tried to support it in https://github.com/GerritCodeReview/gerrit/blob/master/java/com/google/gerrit/httpd/WebSessionManager.java but also failed (again did this a while ago).",
      "parentUuid": "efcb9490_0ac9f658",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "743cdd49_6e64943d",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-15T22:48:46Z",
      "side": 1,
      "message": "If you try again and ask for help, I will try to help.",
      "parentUuid": "ed9dc6d2_6a353f06",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "164f035c_6ca827f6",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2019-10-17T21:38:37Z",
      "side": 1,
      "message": "Thanks, so i\u0027m stuck at the bit where you get all keys and then get the account key from it.\n\nE.g in this plugin we do:\n\n\n  public void invalidate(Account.Id account) {\n    for (Path path : listFiles()) {\n      if (readFile(path).getAccountId().get() \u003d\u003d account.get()) {\n        invalidate(Object account);\n      }\n    }\n  }\n\nwhich calls:\n\n  private Val readFile(Path path) {\n    if (path.toFile().exists()) {\n      try (InputStream fileStream \u003d Files.newInputStream(path);\n          ObjectInputStream objStream \u003d new ObjectInputStream(fileStream)) {\n        return (Val) objStream.readObject();\n      } catch (ClassNotFoundException e) {\n        log.warn(\n            \"Entry \"\n                + path\n                + \" in cache \"\n                + websessionsDir\n                + \" has an incompatible \"\n                + \"class and can\u0027t be deserialized. Invalidating entry.\");\n        invalidate(path.getFileName().toString());\n      } catch (IOException e) {\n        log.warn(\"Cannot read cache \" + websessionsDir, e);\n      }\n    }\n    return null;\n  }\n\n\nI\u0027m not sure how to do this in gerrit\u0027s core for H2CacheImpl, any ideas how?",
      "parentUuid": "743cdd49_6e64943d",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1a0eeb6e_a7054cfa",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T21:46:45Z",
      "side": 1,
      "message": "The CacheBasedWebSession has a logout() method, does calling that not work?",
      "parentUuid": "164f035c_6ca827f6",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aaaf5f79_c2b4e296",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2019-10-17T21:56:45Z",
      "side": 1,
      "message": "I doin\u0027t think so as we would be using ssh, so it wouldn\u0027t know about the users session.",
      "parentUuid": "1a0eeb6e_a7054cfa",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "30be5a54_fb06186c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T22:02:42Z",
      "side": 1,
      "message": "Figure out how to get the user\u0027s session from ssh?\n\nTry Injecting a DynamicItem\u003cWebSession\u003e? You may need to modify the gerrit bindings to make that available in the ssh scope, not just the httpscope. @DavidO, is this possible?",
      "parentUuid": "aaaf5f79_c2b4e296",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7b0e9bdf_4610e8f8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T22:27:20Z",
      "side": 1,
      "message": "Also, if you can\u0027t inject a DynamicItem\u003cWebSession\u003e, try injecting a WebSessionManager.",
      "parentUuid": "30be5a54_fb06186c",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a41f8efa_3632bbd4",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2019-10-17T22:32:34Z",
      "side": 1,
      "message": "I have something like:\n\nhttps://phabricator.wikimedia.org/P9384\n\nWhich  builds, but when gerrit starts up it fails with:\n\n1) Could not find a suitable constructor in com.google.gerrit.extensions.registration.DynamicItem. Classes must have either one (and only one) constructor annotated with @Inject or a zero-argument constructor that is not private.\n  at com.google.gerrit.extensions.registration.DynamicItem.class(DynamicItem.java:37)\n  while locating com.google.gerrit.extensions.registration.DynamicItem\u003ccom.google.gerrit.httpd.WebSession\u003e\n    for the 5th parameter of com.google.gerrit.server.cache.h2.H2CacheFactory.\u003cinit\u003e(H2CacheFactory.java:73)\n  at com.google.gerrit.server.cache.h2.H2CacheModule.configure(H2CacheModule.java:26)\n\n1 error\n\tat com.google.inject.internal.Errors.throwCreationExceptionIfErrorsExist(Errors.java:543)\n\tat com.google.inject.internal.InternalInjectorCreator.initializeStatically(InternalInjectorCreator.java:159)\n\tat com.google.inject.internal.InternalInjectorCreator.build(InternalInjectorCreator.java:106)\n\tat com.google.inject.internal.InjectorImpl.createChildInjector(InjectorImpl.java:237)\n\tat com.google.gerrit.pgm.Daemon.createSysInjector(Daemon.java:483)\n\tat com.google.gerrit.pgm.Daemon.start(Daemon.java:331)\n\tat com.google.gerrit.pgm.Daemon.run(Daemon.java:254)\n\tat com.google.gerrit.pgm.util.AbstractProgram.main(AbstractProgram.java:61)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat com.google.gerrit.launcher.GerritLauncher.invokeProgram(GerritLauncher.java:224)\n\tat com.google.gerrit.launcher.GerritLauncher.mainImpl(GerritLauncher.java:120)\n\tat com.google.gerrit.launcher.GerritLauncher.main(GerritLauncher.java:65)\n\tat Main.main(Main.java:28)\n\n\n\n\nI\u0027m not sure how i would use WebSessionManager in there.",
      "parentUuid": "7b0e9bdf_4610e8f8",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c8ac588_62c63ea1",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/LogUsersOutCommand.java",
        "patchSetId": 3
      },
      "lineNbr": 49,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2019-10-17T22:45:10Z",
      "side": 1,
      "message": "I can\u0027t code review that link. I don\u0027t understand what that code is supposed to be doing. I am suggesting doing those injections here in the ssh command.",
      "parentUuid": "a41f8efa_3632bbd4",
      "range": {
        "startLine": 49,
        "startChar": 19,
        "endLine": 49,
        "endChar": 37
      },
      "revId": "c5790f0b548ad126a57c2a8158864beaab5489bb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}