{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a8a52363_7721018c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 2
      },
      "lineNbr": 103,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2022-01-20T18:20:26Z",
      "side": 0,
      "message": "This is a change of functionality though.\n\nBefore this change:\nsessions are expired at the session creation time - (maxAge value *at the time* the session was created).\n\nAfter this change:\nsessions are expired at the session creation time - maxAge\n\nExample: maxAge \u003d 10 days, user John creates a session on the 1st of January. On the 2nd of January, the Gerrit admin sets maxAge \u003d 1 day  and restarts Gerrit.\n\nBefore this change: John\u0027s session expires on the 11th of January\nAfter this change: John\u0027s session expires on the 2nd of January\n\nThis change in behaviour needs to be documented IMHO and clearly stated on the commit message.",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 103,
        "endChar": 69
      },
      "revId": "5e8efcd3256c654576900bfb929c07450ba2932f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "287f7632_5f649523",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 2
      },
      "lineNbr": 103,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-21T11:06:10Z",
      "side": 0,
      "message": "Done",
      "parentUuid": "a8a52363_7721018c",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 103,
        "endChar": 69
      },
      "revId": "5e8efcd3256c654576900bfb929c07450ba2932f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e039ba0e_194db67d",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 2
      },
      "lineNbr": 103,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2022-01-25T00:26:24Z",
      "side": 0,
      "message": "Do we really want the behavior in the plugin for maxAge to differ from core? That\u0027s my main concern here.\n\nWhat if we did a compromise solution where you use time on disk first and then checked expiresAt? That still creates a difference from core in the scenario where maxAge is changed to be longer than previously.\n\nCould you change the on-disk layout to shard by expiration date? Then you\u0027d avoid the problem of looking at all the files and still be able to match core behavior.",
      "parentUuid": "287f7632_5f649523",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 103,
        "endChar": 69
      },
      "revId": "5e8efcd3256c654576900bfb929c07450ba2932f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "200fe7cd_4de01703",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 2
      },
      "lineNbr": 103,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2022-01-25T01:21:02Z",
      "side": 0,
      "message": "If your primary concern is memory usage, getting rid of listFiles() which returns a List instead of a Stream would be a welcomed change which will likely help with that. I would like to see how well such a change used in production works, and whether this is good enough before I would try to modify how the expiration date is looked up.",
      "parentUuid": "e039ba0e_194db67d",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 103,
        "endChar": 69
      },
      "revId": "5e8efcd3256c654576900bfb929c07450ba2932f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "35ae9018_4eefe86a",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/websession/flatfile/FlatFileWebSessionCache.java",
        "patchSetId": 2
      },
      "lineNbr": 103,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-01-25T18:08:16Z",
      "side": 0,
      "message": "@Martin, @Nasser I think you both made really good points.\nPlease see if the new CRs are any better.",
      "parentUuid": "200fe7cd_4de01703",
      "range": {
        "startLine": 101,
        "startChar": 0,
        "endLine": 103,
        "endChar": 69
      },
      "revId": "5e8efcd3256c654576900bfb929c07450ba2932f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}